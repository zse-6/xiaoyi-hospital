<!--pages/navigation/navigation.wxml-->
<view class="navigation-page">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="page-header">
    <view class="header-content">
      <text class="hospital-name">{{currentHospital.name}}</text>
      <text class="hospital-level">{{currentHospital.level}}</text>
    </view>
    <view class="hospital-address">
      <text>ğŸ“ {{currentHospital.address}}</text>
    </view>
  </view>

  <!-- æ¨¡å¼åˆ‡æ¢ -->
  <view class="mode-tabs">
    <view 
      class="mode-tab {{navigationMode === 'floor' ? 'active' : ''}}" 
      bindtap="switchMode"
      data-mode="floor"
    >
      <text class="tab-icon">ğŸ¢</text>
      <text>æ¥¼å±‚å¯¼èˆª</text>
    </view>
    <view 
      class="mode-tab {{navigationMode === 'indoor' ? 'active' : ''}}" 
      bindtap="switchMode"
      data-mode="indoor"
    >
      <text class="tab-icon">ğŸ—ºï¸</text>
      <text>å®¤å†…å¯¼èˆª</text>
    </view>
    <view 
      class="mode-tab {{navigationMode === 'out' ? 'active' : ''}}" 
      bindtap="switchMode"
      data-mode="out"
    >
      <text class="tab-icon">ğŸ“</text>
      <text>é™¢å¤–å¯¼èˆª</text>
    </view>
  </view>

  <!-- æœç´¢æ¡† -->
  <view class="search-section">
    <view class="search-container">
      <view class="search-icon">ğŸ”</view>
      <input 
        class="search-input" 
        placeholder="æœç´¢ç§‘å®¤ã€è¯Šå®¤æˆ–æœåŠ¡ç‚¹..."
        value="{{searchKeyword}}"
        bindinput="onSearchInput"
        focus="{{showSearch}}"
      />
      <view class="search-cancel" wx:if="{{searchKeyword}}" bindtap="resetNavigation">
        <text>å–æ¶ˆ</text>
      </view>
    </view>
  </view>

  <!-- æœç´¢ç»“æœæ˜¾ç¤º -->
  <view class="search-results" wx:if="{{showSearch && searchResults.length > 0}}">
    <view class="results-header">
      <text>æœç´¢ç»“æœ ({{searchResults.length}})</text>
    </view>
    <block wx:for="{{searchResults}}" wx:key="id">
      <view 
        class="result-item" 
        bindtap="selectSearchResult"
        data-result="{{item}}"
      >
        <text class="result-icon">{{item.icon}}</text>
        <view class="result-info">
          <text class="result-name">{{item.name}}</text>
          <text class="result-details">{{item.floor}} Â· {{item.type}}</text>
        </view>
        <text class="result-arrow">â€º</text>
      </view>
    </block>
  </view>

  <!-- æ¥¼å±‚å¯¼èˆªæ¨¡å¼ -->
  <view class="content-section" wx:if="{{navigationMode === 'floor'}}">
    <!-- å®æ™¯å›¾ç‰‡ -->
    <view class="image-gallery">
      <text class="section-title">ğŸ¥ åŒ»é™¢å®æ™¯</text>
      <view class="image-list">
        <block wx:for="{{previewImages}}" wx:key="id">
          <view class="image-item" bindtap="viewRealImage" data-image="{{item}}">
            <view class="image-placeholder">
              <text class="placeholder-icon">ğŸ–¼ï¸</text>
              <text class="placeholder-text">{{item.description}}</text>
            </view>
          </view>
        </block>
      </view>
    </view>

    <!-- æ¥¼å±‚å¯¼èˆª -->
    <view class="floors-navigation">
      <text class="section-title">ğŸ¢ æ¥¼å±‚å¯¼èˆª</text>
      <block wx:for="{{floors}}" wx:key="floor">
        <view class="floor-section">
          <view 
            class="floor-header" 
            bindtap="toggleFloor" 
            data-floor="{{item.floor}}"
          >
            <view class="floor-title">
              <text class="floor-icon">ğŸ›—</text>
              <text>{{item.floor}}</text>
            </view>
            <text class="expand-icon">{{expandedFloor === item.floor ? 'âˆ’' : '+'}}</text>
          </view>
          
          <view class="floor-content" wx:if="{{expandedFloor === item.floor}}">
            <block wx:for="{{item.departments}}" wx:key="id">
              <view 
                class="department-item" 
                bindtap="selectDepartment"
                data-department="{{item}}"
                data-floor="{{item.floor}}"
              >
                <text class="dept-icon">{{item.icon}}</text>
                <view class="dept-info">
                  <text class="dept-name">{{item.name}}</text>
                  <text class="dept-type">{{item.type}}</text>
                </view>
                <text class="nav-arrow">â¡ï¸</text>
              </view>
            </block>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- å®¤å†…å¯¼èˆªæ¨¡å¼ -->
  <view class="content-section" wx:if="{{navigationMode === 'indoor'}}">
    <view class="indoor-map">
      <text class="section-title">ğŸ—ºï¸ å®¤å†…å¹³é¢å›¾</text>
      <view class="map-container">
        <!-- è¿™é‡Œå¯ä»¥æ”¾ç½®å®é™…çš„åœ°å›¾å›¾ç‰‡ -->
        <view class="map-placeholder">
          <text class="map-text">åŒ»é™¢å®¤å†…å¹³é¢å›¾</text>
          <text class="map-tip">ç‚¹å‡»åœ°å›¾ä¸Šçš„ä½ç½®ç‚¹å¯å¼€å§‹å¯¼èˆª</text>
        </view>
      </view>
      
      <view class="map-legend">
        <view class="legend-item">
          <view class="legend-color entrance"></view>
          <text>å…¥å£</text>
        </view>
        <view class="legend-item">
          <view class="legend-color service"></view>
          <text>æœåŠ¡çª—å£</text>
        </view>
        <view class="legend-item">
          <view class="legend-color clinic"></view>
          <text>è¯Šå®¤</text>
        </view>
        <view class="legend-item">
          <view class="legend-color pharmacy"></view>
          <text>è¯æˆ¿</text>
        </view>
      </view>
    </view>
  </view>

  <!-- é™¢å¤–å¯¼èˆªæ¨¡å¼ -->
  <view class="content-section" wx:if="{{navigationMode === 'out'}}">
    <view class="hospitals-list">
      <text class="section-title">ğŸ¥ é™„è¿‘åŒ»é™¢</text>
      <block wx:for="{{hospitals}}" wx:key="id">
        <view 
          class="hospital-card" 
          bindtap="selectHospital"
          data-hospital="{{item}}"
        >
          <view class="hospital-header">
            <text class="hospital-name">{{item.name}}</text>
            <view class="hospital-tags">
              <view class="tag level">{{item.level}}</view>
              <view class="tag distance">ğŸ“ {{item.distance}}</view>
            </view>
          </view>
          
          <view class="hospital-info">
            <text class="info-item">ğŸ“ {{item.address}}</text>
            <text class="info-item">â±ï¸ çº¦{{item.time}}è½¦ç¨‹</text>
          </view>
          
          <view class="hospital-departments">
            <text class="dept-label">ä¸»è¦ç§‘å®¤ï¼š</text>
            <view class="dept-tags">
              <block wx:for="{{item.departments}}" wx:key="*this">
                <view class="dept-tag">
                  <text>{{item}}</text>
                </view>
              </block>
            </view>
          </view>
        </view>
      </block>
    </view>
  </view>

  <!-- å¯¼èˆªæŒ‡å¼•é¢æ¿ -->
  <view class="navigation-panel" wx:if="{{showNavigation}}">
    <view class="panel-header">
      <text class="panel-title">å¯¼èˆªæŒ‡å¼•</text>
      <view class="close-btn" bindtap="resetNavigation">
        <text>âœ•</text>
      </view>
    </view>
    
    <view class="route-info">
      <text class="route-from">ğŸ“ å½“å‰ä½ç½®ï¼š{{currentLocation}}</text>
      <text class="route-to">ğŸ¯ ç›®æ ‡ä½ç½®ï¼š{{targetLocation}}</text>
    </view>
    
    <view class="steps-list">
      <block wx:for="{{navigationPath}}" wx:key="step">
        <view class="step-item">
          <text class="step-icon">{{item.icon}}</text>
          <text class="step-number">{{item.step}}</text>
          <text class="step-instruction">{{item.instruction}}</text>
        </view>
      </block>
    </view>
    
    <button class="start-navigation-btn" bindtap="startNavigation">
      <text>ğŸš€ å¼€å§‹å¯¼èˆª</text>
    </button>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="action-bar">
    <view class="action-btn" bindtap="callHospital">
      <text class="btn-icon">ğŸ“</text>
      <text>ç”µè¯å’¨è¯¢</text>
    </view>
    <view class="action-btn" bindtap="viewHospitalLocation">
      <text class="btn-icon">ğŸ“</text>
      <text>æŸ¥çœ‹ä½ç½®</text>
    </view>
    <view class="action-btn" bindtap="resetNavigation">
      <text class="btn-icon">ğŸ”„</text>
      <text>é‡ç½®å¯¼èˆª</text>
    </view>
  </view>
</view>